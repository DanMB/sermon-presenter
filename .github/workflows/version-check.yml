name: Version check

on:
  pull_request:
    branches: ['main']

jobs:
  client:
    name: Check client version
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Checking app... ðŸ”Ž
        uses: avides/actions-project-version-check@v1.3.0
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          file-to-check: package.json

  app:
    name: Check app version
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Checking app... ðŸ”Ž
        uses: avides/actions-project-version-check@v1.3.0
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          file-to-check: neutralino.config.json

  validate:
    if: ${{ always() }}
    needs: [client, app]
    name: Validate version bumped
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Validating âœ¨
        if: ${{ !(needs.client.outputs || needs.app.outputs) }}
        uses: actions/github-script@v3
        with:
          script: |
            core.setFailed('Version number of package or neutralino config has not changed')
